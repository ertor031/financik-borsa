<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–ì–ª–∞–≤–Ω–∞—è</title>
  <link rel="stylesheet" href="style.css">
  <style>
    #clock { position: fixed; top: 10px; right: 20px; font-size: 24px; background: rgba(255,255,255,0.7); color: #000; padding: 5px 10px; border-radius: 8px; }
    canvas { position: fixed; top:0; left:0; width:100%; height:100%; pointer-events:none; z-index:9999; }
    #enable-sound { position: fixed; bottom: 20px; right: 20px; padding: 10px 20px; font-size: 18px; cursor: pointer; z-index: 10000; }
  </style>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
</head>
<body>
  <header class="top-menu">
    <h1>GOLD TYR</h1>
    <div></div>
    <div id="clock"></div>
  </header>

  <div class="container">
    <h1>Deposit üéâüéâüéâ</h1>
    <p id="name-display">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
    <img src="american-dollar-bills-removebg-preview.png" alt="–§–æ—Ç–æ" class="top-photo">
  </div>

  <div class="ticker-container">
    <div class="ticker-track" id="ticker"></div>
  </div>

  <!-- üéµ –ú—É–∑—ã–∫–∞ -->
  <audio id="music" src="fireworks.mp3" preload="auto"></audio>
  <button id="enable-sound">–í–∫–ª—é—á–∏—Ç—å –∑–≤—É–∫ üîä</button>

  <script>
    // ----------------- Firebase -----------------
    const firebaseConf = {
      apiKey: "AIzaSyByiF-7RJ1wDoqmdHqXHwwq4T9flMLZSwQ",
      authDomain: "depos-a9432.firebaseapp.com",
      databaseURL: "https://depos-a9432-default-rtdb.firebaseio.com",
      projectId: "depos-a9432",
      storageBucket: "depos-a9432.appspot.com",
      messagingSenderId: "1094522234099",
      appId: "1:1094522234099:web:6f85cc37a92e9554430386"
    };
    if (!firebase.apps.length) firebase.initializeApp(firebaseConf);
    const db = firebase.database();
    const nameDisplay = document.getElementById("name-display");
    const music = document.getElementById("music");

    let lastName = null;
    let soundEnabled = false;

    // –ö–Ω–æ–ø–∫–∞ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –∑–≤—É–∫–∞
    document.getElementById("enable-sound").addEventListener("click", () => {
      soundEnabled = true;
      document.getElementById("enable-sound").style.display = "none"; // —Å–∫—Ä—ã—Ç—å –∫–Ω–æ–ø–∫—É
      music.play().catch(()=>{}); // –æ–¥–∏–Ω –∑–∞–ø—É—Å–∫, —á—Ç–æ–±—ã –±—Ä–∞—É–∑–µ—Ä —Ä–∞–∑—Ä–µ—à–∏–ª
      music.pause();
    });

    db.ref("latestName").on("value", snapshot => {
      const name = snapshot.val();
      nameDisplay.textContent = (name || "–ò–º—è –ø–æ–∫–∞ –Ω–µ –∑–∞–¥–∞–Ω–æ") + " üíµ";

      if (name !== lastName) {
        music.currentTime = 0;
        music.play().catch(err => console.log("–ù–µ —É–¥–∞–ª–æ—Å—å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏:", err));
      }
      lastName = name;
    });

    // ----------------- –ß–∞—Å—ã -----------------
    const clock = document.getElementById("clock");
    function updateClock() {
      const now = new Date();
      const h = String(now.getHours()).padStart(2,'0');
      const m = String(now.getMinutes()).padStart(2,'0');
      const s = String(now.getSeconds()).padStart(2,'0');
      clock.textContent = `${h}:${m}:${s}`;
    }
    setInterval(updateClock, 1000);
    updateClock();
  </script>

  <script>
  const FINNHUB_KEY = "d3d57d9r01qmnfgg6r0gd3d57d9r01qmnfgg6r10";

  const stockTickers = ['AAPL','GOOGL','TSLA','MSFT','AMZN','NFLX'];
  const cryptoTickers = ['bitcoin','ethereum','ripple','dogecoin','litecoin','cardano'];

  function getRandom(arr) {
    return arr[Math.floor(Math.random()*arr.length)];
  }

  async function getStockPrice(ticker) {
    try {
      const res = await fetch(`https://finnhub.io/api/v1/quote?symbol=${ticker}&token=${FINNHUB_KEY}`);
      const data = await res.json();
      if(data.c) return `${ticker}: $${data.c.toFixed(2)}`;
      return `${ticker}: –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö`;
    } catch(e) {
      return `${ticker}: –û—à–∏–±–∫–∞`;
    }
  }

  async function getCryptoPrice(id) {
    try {
      const res = await fetch(`https://api.coingecko.com/api/v3/simple/price?ids=${id}&vs_currencies=usd`);
      const data = await res.json();
      if(data[id]) return `${id.toUpperCase()}: $${data[id].usd}`;
      return `${id.toUpperCase()}: –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö`;
    } catch(e) {
      return `${id.toUpperCase()}: –û—à–∏–±–∫–∞`;
    }
  }

  async function generateTickerItems(count = 20) {
    const items = [];
    for(let i = 0; i < count; i++) {
      if(Math.random() < 0.5) {
        const stock = getRandom(stockTickers);
        items.push(await getStockPrice(stock));
      } else {
        const crypto = getRandom(cryptoTickers);
        items.push(await getCryptoPrice(crypto));
      }
    }
    return items;
  }

  async function startTicker() {
    const ticker = document.getElementById("ticker");
    const items = await generateTickerItems(30);
    ticker.innerHTML = items.map(item => `<span class="ticker-item">${item}</span>`).join("");
  }

  startTicker();
  </script>
</body>
</html>
